name: new_repository

on: ["push"]

jobs:
  initialize:
    if: ${{ github.repository != 'containerly/python-http-fast' }}
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    - uses: azure/docker-login@v1
      with:
        login-server: ${{ secrets.REGISTRY_LOGIN_SERVER }}
        username: ${{ secrets.REGISTRY_USERNAME }}
        password: ${{ secrets.REGISTRY_PASSWORD }}
    - run: |
        docker pull ${{ secrets.REGISTRY_LOGIN_SERVER }}/containerly:0cf03b89801341424fce655f553ff0f03ee74d72
    - run: |
        docker run -v $(pwd):/workspace ${{ secrets.REGISTRY_LOGIN_SERVER }}/containerly:0cf03b89801341424fce655f553ff0f03ee74d72 repository /workspace --name example  
    - uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: "clone and code"
        push_options: --force